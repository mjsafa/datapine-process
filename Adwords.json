{"processDefinition":{"name":"adwords-reports","steps":[{"type":"Adwords","name":"get_client_ids","properties":{"resource":"clientCustomerIds"},"outputs":[{"name":"success","destination":"get_report_definitions","condition":"@{credentials.config.properties.clientCustomerIds.contains(item.content)}"}],"itemAttributes":{"customerId":"@{item.content}"},"x":0,"y":0},{"type":"Adwords","name":"get_report_definitions","properties":{"resource":"reportDescriptors"},"outputs":[{"name":"success","destination":"report_intervals","condition":"@{credentials.config.properties.reports.contains(item.content.report + '_' + item.content.subReport) && item.content.report != 'CLICK_PERFORMANCE_REPORT'}"},{"name":"success","destination":"clean_click_performance","condition":"@{credentials.config.properties.reports.contains(item.content.report + '_' + item.content.subReport) && item.content.report == 'CLICK_PERFORMANCE_REPORT'}"}],"itemAttributes":{"report":"@{item.content.report}","subReport":"@{item.content.subReport}","descriptor":"@{item.content.descriptor}"},"x":270,"y":0},{"type":"DeleteFromDB","name":"clean_click_performance","properties":{"tables":["@{item.attributes.report}_@{item.attributes.subReport}"],"predicates":[{"field":"Date","operator":"between","start":"@{now().minusDays(1)}","end":"@{currentDate().atStartOfDay().minusMinutes(1)}"}]},"outputs":[{"name":"success","destination":"execute_click_performance"}],"itemAttributes":{},"x":540,"y":0},{"type":"Adwords","name":"execute_click_performance","properties":{"resource":"executeReport","customerId":"@{item.attributes.customerId}","from":"@{now().minusDays(1)}","until":"@{now().minusDays(1)}","report":"@{item.attributes.report}","reportDescriptor":{"excludedMetrics":"@{item.attributes.descriptor.excludedMetrics}","excludedSegments":"@{item.attributes.descriptor.excludedSegments}","includedMetrics":"@{[]}","includedSegments":"@{[]}"}},"outputs":[{"name":"success","destination":"save_report"}],"itemAttributes":{},"x":810,"y":0},{"type":"GetIntervals","name":"report_intervals","properties":{"totalMonths":30,"batchDays":"@{config.batchDays}","daysToExtract":"@{config.partialExtractionDays}"},"outputs":[{"name":"success","destination":"clean_reports","condition":"@{item.attributes.report != 'BUDGET_PERFORMANCE_REPORT'}"},{"name":"success","destination":"clean_without_date","condition":"@{item.attributes.report == 'BUDGET_PERFORMANCE_REPORT'}"}],"itemAttributes":{"from":"@{item.content.from}","until":"@{item.content.until}"},"x":540,"y":120},{"type":"DeleteFromDB","name":"clean_without_date","properties":{"tables":["@{item.attributes.report}_@{item.attributes.subReport}"]},"outputs":[{"name":"success","destination":"execute_reports"}],"itemAttributes":{},"x":810,"y":120},{"type":"DeleteFromDB","name":"clean_reports","properties":{"tables":["@{item.attributes.report}_@{item.attributes.subReport}"],"predicates":[{"field":"Date","operator":"between","start":"@{item.attributes.from}","end":"@{item.attributes.until}"}]},"outputs":[{"name":"success","destination":"execute_reports"}],"itemAttributes":{},"x":810,"y":240},{"type":"Adwords","name":"execute_reports","properties":{"resource":"executeReport","customerId":"@{item.attributes.customerId}","from":"@{item.attributes.from}","until":"@{item.attributes.until}","report":"@{item.attributes.report}","reportDescriptor":{"excludedMetrics":"@{item.attributes.descriptor.excludedMetrics}","excludedSegments":"@{item.attributes.descriptor.excludedSegments}","includedMetrics":"@{[]}","includedSegments":"@{[]}"}},"outputs":[{"name":"success","destination":"save_report"}],"itemAttributes":{},"x":1080,"y":240},{"type":"SaveCsvIntoDB","name":"save_report","properties":{"tableName":"@{item.attributes.report}_@{item.attributes.subReport}","ignoreLastRows":1,"rowExpression":"@{ADWORDS.getValue(item.attributes.report, header, field)}","extraFields":{"clientCustomerId":"@{item.attributes.customerId}"}},"outputs":[],"itemAttributes":{},"x":1350,"y":240}],"excludes":["clean_click_performance","save_report"],"generalSteps":[]},"extractor":{"id":0,"timePeriod":0,"active":false,"errorCounter":0},"connectorCredentials":{"id":0,"organizationId":112,"datasourceId":33758,"connectorType":"GOOGLE_ADWORDS","refreshToken":"1/pQqt7QJ0HCAVX7mpxDNhOsgTxUCRcrYTg0vy00XTtHR__777C2t0BeIihN61dlSZ","datamart":"localhost","config":{"properties":{"reports":["AUDIENCE_PERFORMANCE_REPORT_Normal"],"clientCustomerIds":"6241117324"}}}}