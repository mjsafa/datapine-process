{"processDefinition":{"name":"adwords-reports","steps":[{"type":"Adwords","name":"get_client_ids","properties":{"resource":"clientCustomerIds"},"outputs":[{"name":"success","destination":"get_report_definitions","condition":"@{credentials.config.properties.clientCustomerIds.contains(item.content)}"}],"itemAttributes":{"customerId":"@{item.content}"},"extendsStep":null},{"type":"Adwords","name":"get_report_definitions","properties":{"resource":"reportDescriptors"},"outputs":[{"name":"success","destination":"report_intervals","condition":"@{credentials.config.properties.reports.contains(item.content.report + '_' + item.content.subReport) && item.content.report != 'CLICK_PERFORMANCE_REPORT'}"},{"name":"success","destination":"clean_click_performance","condition":"@{credentials.config.properties.reports.contains(item.content.report + '_' + item.content.subReport) && item.content.report == 'CLICK_PERFORMANCE_REPORT'}"},{"name":"success","destination":"clean_without_date","condition":"@{credentials.config.properties.reports.contains(item.content.report + '_' + item.content.subReport) && item.attributes.report == 'BUDGET_PERFORMANCE_REPORT'}"}],"itemAttributes":{"report":"@{item.content.report}","subReport":"@{item.content.subReport}","descriptor":"@{item.content.descriptor}"},"extendsStep":null},{"type":"DeleteFromDB","name":"clean_click_performance","properties":{"tables":["@{item.attributes.report}_@{item.attributes.subReport}"],"predicates":[{"field":"Date","operator":"between","start":"@{now().minusDays(1)}","end":"@{currentDate().atStartOfDay().minusMinutes(1)}"}]},"outputs":[{"name":"success","destination":"execute_click_performance","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"Adwords","name":"execute_click_performance","properties":{"resource":"executeReport","customerId":"@{item.attributes.customerId}","from":"@{now().minusDays(1)}","until":"@{now().minusDays(1)}","report":"@{item.attributes.report}","reportDescriptor":{"excludedMetrics":"@{item.attributes.descriptor.excludedMetrics}","excludedSegments":"@{item.attributes.descriptor.excludedSegments}","includedMetrics":"@{[]}","includedSegments":"@{[]}"}},"outputs":[{"name":"success","destination":"save_report","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"GetIntervals","name":"report_intervals","properties":{"totalMonths":"@{config.monthsToExtract}","batchDays":"@{config.batchDays}","daysToExtract":"@{config.partialExtractionDays}"},"outputs":[{"name":"success","destination":"clean_reports","condition":"@{item.attributes.report != 'BUDGET_PERFORMANCE_REPORT'}"}],"itemAttributes":{"from":"@{item.content.from}","until":"@{item.content.until}"},"extendsStep":null},{"type":"DeleteFromDB","name":"clean_without_date","properties":{"tables":["@{item.attributes.report}_@{item.attributes.subReport}"]},"outputs":[{"name":"success","destination":"execute_reports","condition":null}],"itemAttributes":{"from":"@{now().minusMonths(config.monthsToExtract)}","until":"@{now()}"},"extendsStep":null},{"type":"DeleteFromDB","name":"clean_reports","properties":{"tables":["@{item.attributes.report}_@{item.attributes.subReport}"],"predicates":[{"field":"Date","operator":"between","start":"@{item.attributes.from.toLocalDate().atStartOfDay()}","end":"@{item.attributes.until}"}]},"outputs":[{"name":"success","destination":"execute_reports","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"Adwords","name":"execute_reports","properties":{"resource":"executeReport","customerId":"@{item.attributes.customerId}","from":"@{item.attributes.from}","until":"@{item.attributes.until}","report":"@{item.attributes.report}","reportDescriptor":{"excludedMetrics":"@{item.attributes.descriptor.excludedMetrics}","excludedSegments":"@{item.attributes.descriptor.excludedSegments}","includedMetrics":"@{[]}","includedSegments":"@{[]}"}},"outputs":[{"name":"success","destination":"save_report","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"SaveCsvIntoDB","name":"save_report","properties":{"tableName":"@{item.attributes.report}_@{item.attributes.subReport}","ignoreLastRows":1,"rowExpression":"@{ADWORDS.getValue(item.attributes.report, header, field)}","extraFields":{"clientCustomerId":"@{item.attributes.customerId}"}},"outputs":[],"itemAttributes":{},"extendsStep":null}],"excludes":[],"generalSteps":[],"dependencies":null,"ignoreExceptionTypes":null,"exceptionIgnoreExpression":null},"extractor":{"id":0,"publicId":null,"lastExecution":null,"startExecution":null,"finishExecution":null,"queuedExecution":null,"nextExecution":null,"timeUnit":null,"timePeriod":0,"active":false,"status":null,"errorType":null,"message":null,"errorCounter":0,"fullExtraction":true},"connectorCredentials":{"id":0,"organizationId":112,"datasourceId":33758,"connectorType":"GOOGLE_ADWORDS","creationDate":null,"refreshToken":"1//03B0tWRnQ41bnCgYIARAAGAMSNwF-L9IrXfv-nX4iAvC0FK5UbkShkZ2gCEDvrF1yjr97FQjcV_p7fTLWQnvOcXeifYGq1SZjgP0","datamart":"localhost","config":"{\"properties\":{\"reports\":[\"PLACEHOLDER_REPORT_Normal\",\"PLACEMENT_PERFORMANCE_REPORT_Normal\",\"PRODUCT_PARTITION_REPORT_Normal\",\"SEARCH_QUERY_PERFORMANCE_REPORT_Normal\",\"SHOPPING_PERFORMANCE_REPORT_Normal\",\"TOP_CONTENT_PERFORMANCE_REPORT_Normal\",\"URL_PERFORMANCE_REPORT_Normal\",\"USER_AD_DISTANCE_REPORT_Normal\",\"VIDEO_PERFORMANCE_REPORT_Normal\"],\"clientCustomerIds\":\"8436870888\"},\"to\":[]}","extractor":null}}