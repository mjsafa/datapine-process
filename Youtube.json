{"processDefinition":{"name":"youtube_videos","steps":[{"type":"YouTube","name":"get_youtube","properties":{"url":"channels","params":{"part":"id,statistics,topicDetails,contentDetails,status,snippet,localizations,brandingSettings","mine":"true"}},"outputs":[{"name":"success","destination":"split_channels","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"DeleteFromDB","name":"clean_channels","properties":{"tables":["Channels"]},"outputs":[{"name":"success","destination":"get_youtube","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"YouTube","name":"get_playlists","properties":{"url":"playlists","params":{"part":"id,contentDetails,status,snippet","mine":true,"maxResults":50}},"outputs":[{"name":"success","destination":"split_playlists","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"SplitJsonArray","name":"split_playlists","properties":{"propertyJsonArray":"@{evalJson(item, '$.items')}"},"outputs":[{"name":"success","destination":"map_playlists","condition":null},{"name":"success","destination":"get_playlist_items","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"YouTube","name":"get_playlist_items","properties":{"url":"playlistItems","params":{"part":"id,contentDetails,status,snippet","playlistId":"@{evalJson(item, '$.id')}","maxResults":50}},"outputs":[{"name":"success","destination":"split_playlist_items","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"SplitJsonArray","name":"split_playlist_items","properties":{"propertyJsonArray":"@{evalJson(item, '$.items')}"},"outputs":[{"name":"success","destination":"map_playlist_item","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"ToMap","name":"map_playlist_item","properties":{"mappings":{"PublishedAt":"@{toDateTime(evalJson(item, '$.snippet.publishedAt'), 'yyyy-MM-dd\\'T\\'HH:mm:ss[.SSS]\\'Z\\'')}","Id":"@{evalJson(item, '$.id')}","ChannelId":"@{evalJson(item, '$.snippet.channelId')}","ChannelTitle":"@{evalJson(item, '$.snippet.channelTitle')}","PlaylistId":"@{evalJson(item, '$.snippet.playlistId')}","VideoId":"@{evalJson(item, '$.contentDetails.videoId')}","Position":"@{evalJson(item, '$.snippet.position')}","ResourceIdKind":"@{evalJson(item, '$.snippet.resourceId.kind')}","ResourceIdVideoId":"@{evalJson(item, '$.snippet.resourceId.videoId')}","Title":"@{evalJson(item, '$.snippet.title')}","Description":"@{evalJson(item, '$.snippet.description')}","PrivacyStatus":"@{evalJson(item, '$.status.privacyStatus')}"}},"outputs":[{"name":"success","destination":"save_playlist_items","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"InsertMapIntoDB","name":"save_playlist_items","properties":{"tableName":"PlayListItems","batchSize":200},"outputs":[],"itemAttributes":{},"extendsStep":null},{"type":"ToMap","name":"map_playlists","properties":{"mappings":{"PublishedAt":"@{toDateTime(evalJson(item, '$.snippet.publishedAt'), 'yyyy-MM-dd\\'T\\'HH:mm:ss[.SSS]\\'Z\\'')}","Id":"@{evalJson(item, '$.id')}","ChannelId":"@{evalJson(item, '$.snippet.channelId')}","Title":"@{evalJson(item, '$.snippet.title')}","Description":"@{evalJson(item, '$.snippet.description')}","PrivacyStatus":"@{evalJson(item, '$.status.privacyStatus')}","VideoCount":"@{evalJson(item, '$.contentDetails.itemCount')}"}},"outputs":[{"name":"success","destination":"save_playlists","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"InsertMapIntoDB","name":"save_playlists","properties":{"tableName":"PlayLists","batchSize":200},"outputs":[],"itemAttributes":{},"extendsStep":null},{"type":"DeleteFromDB","name":"clean_playlists","properties":{"tables":["PlayLists","PlayListItems"]},"outputs":[{"name":"success","destination":"get_playlists","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"YouTube","name":"get_comment_threads","properties":{"url":"commentThreads","params":{"part":"id,snippet,replies","allThreadsRelatedToChannelId":"@{item.attributes.channelId}","maxResults":100}},"outputs":[{"name":"success","destination":"split_json","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"SplitJsonArray","name":"split_json","properties":{"propertyJsonArray":"@{evalJson(item, '$.items')}"},"outputs":[{"name":"success","destination":"map_comment","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"ToMap","name":"map_comment","properties":{"mappings":{"PublishedAt":"@{toDateTime(evalJson(item, '$.snippet.topLevelComment.snippet.publishedAt'), 'yyyy-MM-dd\\'T\\'HH:mm:ss[.SSS]\\'Z\\'')}","UpdatedAt":"@{toDateTime(evalJson(item, '$.snippet.topLevelComment.snippet.updatedAt'), 'yyyy-MM-dd\\'T\\'HH:mm:ss[.SSS]\\'Z\\'')}","Id":"@{evalJson(item, '$.id')}","VideoId":"@{evalJson(item, '$.snippet.videoId')}","ChannelId":"@{evalJson(item, '$.snippet.channelId')}","TopCommentId":"@{evalJson(item, '$.snippet.topLevelComment.id')}","TopCommentVideoId":"@{evalJson(item, '$.snippet.topLevelComment.snippet.videoId')}","TopCommentTextDisplay":"@{evalJson(item, '$.snippet.topLevelComment.snippet.textDisplay')}","TopCommentTextOriginal":"@{evalJson(item, '$.snippet.topLevelComment.snippet.textOriginal')}","TopCommentAuthorChannelIdValue":"@{evalJson(item, '$.snippet.topLevelComment.snippet.authorChannelId.value')}","TopCommentAuthorDisplayName":"@{evalJson(item, '$.snippet.topLevelComment.snippet.authorDisplayName')}","TopCommentCanRate":"@{evalJson(item, '$.snippet.topLevelComment.snippet.canRate')}","TopCommentViewerRating":"@{evalJson(item, '$.snippet.topLevelComment.snippet.viewerRating')}","TopCommentLikeCount":"@{evalJson(item, '$.snippet.topLevelComment.snippet.likeCount')}","TotalReplyCount":"@{evalJson(item, '$.snippet.totalReplyCount')}","IsPublic":"@{evalJson(item, '$.snippet.isPublic')}"}},"outputs":[{"name":"success","destination":"save_comment_threads","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"InsertMapIntoDB","name":"save_comment_threads","properties":{"tableName":"CommentThreads","batchSize":200},"outputs":[],"itemAttributes":{},"extendsStep":null},{"type":"SplitJsonArray","name":"split_channels","properties":{"propertyJsonArray":"@{evalJson(item, '$.items')}"},"outputs":[{"name":"success","destination":"channel_map","condition":null},{"name":"success","destination":"clean_comment_threads","condition":null},{"name":"success","destination":"clean_subscriptions","condition":null}],"itemAttributes":{"channelId":"@{evalJson(item, '$.id')}"},"extendsStep":null},{"type":"DeleteFromDB","name":"clean_subscriptions","properties":{"tables":["Subscriptions"],"predicates":[{"field":"SourceChannelId","operator":"=","value":"@{item.attributes.channelId}"}]},"outputs":[{"name":"success","destination":"get_subscriptions","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"DeleteFromDB","name":"clean_comment_threads","properties":{"tables":["CommentThreads"],"predicates":[{"field":"ChannelId","operator":"=","value":"@{item.attributes.channelId}"}]},"outputs":[{"name":"success","destination":"get_comment_threads","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"YouTube","name":"search_videos","properties":{"url":"search","params":{"part":"snippet","forMine":true,"type":"video","order":"date","maxResults":50}},"outputs":[{"name":"success","destination":"get_videos","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"DeleteFromDB","name":"clean_videos","properties":{"tableName":"Videos","predicates":[]},"outputs":[{"name":"success","destination":"search_videos","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"YouTube","name":"get_videos","properties":{"url":"videos","params":{"part":"id,snippet,fileDetails,contentDetails,statistics,status,suggestions,localizations,recordingDetails","id":"@{joinToString(evalJson(item, '$.items[*].id.videoId'), ',')}","maxResults":50}},"outputs":[{"name":"success","destination":"split_videos","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"SplitJsonArray","name":"split_videos","properties":{"propertyJsonArray":"@{evalJson(item, '$.items')}"},"outputs":[{"name":"success","destination":"map_videos","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"ToMap","name":"map_videos","properties":{"mappings":{"PublishedAt":"@{toDateTime(evalJson(item, '$.snippet.publishedAt'), 'yyyy-MM-dd\\'T\\'HH:mm:ss[.SSS]\\'Z\\'')}","Id":"@{evalJson(item, '$.id')}","ChannelId":"@{evalJson(item, '$.snippet.channelId')}","CategoryId":"@{evalJson(item, '$.snippet.categoryId')}","Title":"@{evalJson(item, '$.snippet.title')}","Description":"@{evalJson(item, '$.snippet.description')}","LiveBroadcastContent":"@{evalJson(item, '$.snippet.liveBroadcastContent')}","DefaultLanguage":"@{evalJson(item, '$.snippet.defaultLanguage')}","DefaultAudioLanguage":"@{evalJson(item, '$.snippet.defaultAudioLanguage')}","RejectionReason":"@{evalJson(item, '$.snippet.rejectionReason')}","Dimension":"@{evalJson(item, '$.contentDetails.dimension')}","Definition":"@{evalJson(item, '$.contentDetails.definition')}","Caption":"@{evalJson(item, '$.contentDetails.caption')}","LicensedContent":"@{evalJson(item, '$.contentDetails.licensedContent')}","ViewCount":"@{evalJson(item, '$.statistics.viewCount')}","LikeCount":"@{evalJson(item, '$.statistics.likeCount')}","DislikeCount":"@{evalJson(item, '$.statistics.dislikeCount')}","CommentCount":"@{evalJson(item, '$.statistics.commentCount')}","PublicStatsViewable":"@{evalJson(item, '$.status.publicStatsViewable')}","PrivacyStatus":"@{evalJson(item, '$.status.privacyStatus')}","License":"@{evalJson(item, '$.status.license')}","UploadStatus":"@{evalJson(item, '$.status.uploadStatus')}","Embeddable":"@{evalJson(item, '$.status.embeddable')}","LocationDescription":"@{evalJson(item, '$.recordingDetails.locationDescription')}","RecordingDate":"@{toDateTime(evalJson(item, '$.recordingDetails.recordingDate'), 'yyyy-MM-dd\\'T\\'HH:mm:ss[.SSS]\\'Z\\'')}","TagsAggregate":"@{joinToString(evalJson(item, '$.snippet.tags[*]'), ',')}","duration":"@{parseDurationToSeconds(evalJson(item, '$.contentDetails.duration'))}"}},"outputs":[{"name":"success","destination":"save_video","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"InsertMapIntoDB","name":"save_video","properties":{"tableName":"Videos","batchSize":200},"outputs":[],"itemAttributes":{},"extendsStep":null},{"type":"YouTube","name":"get_subscriptions","properties":{"url":"subscriptions","params":{"part":"id,subscriberSnippet,snippet,contentDetails","maxResults":50,"mySubscribers":true,"forChannelId":"@{item.attributes.channelId}"}},"outputs":[{"name":"success","destination":"split_subscriptions","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"SplitJsonArray","name":"split_subscriptions","properties":{"propertyJsonArray":"@{evalJson(item, '$.items')}"},"outputs":[{"name":"success","destination":"map_subscriptions","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"ToMap","name":"map_subscriptions","properties":{"mappings":{"PublishedAt":"@{toDateTime(evalJson(item, '$.snippet.publishedAt'), 'yyyy-MM-dd\\'T\\'HH:mm:ss[.SSS]\\'Z\\'')}","Id":"@{evalJson(item, '$.id')}","Title":"@{evalJson(item, '$.snippet.title')}","Description":"@{evalJson(item, '$.snippet.description')}","ResourceIdKind":"@{evalJson(item, '$.snippet.resourceId.kind')}","SourceChannelId":"@{evalJson(item, '$.snippet.resourceId.channelId')}","ChannelId":"@{evalJson(item, '$.snippet.channelId')}","TotalItemCount":"@{evalJson(item, '$.contentDetails.totalItemCount')}","NewItemCount":"@{evalJson(item, '$.contentDetails.newItemCount')}","ActivityType":"@{evalJson(item, '$.contentDetails.activityType')}"}},"outputs":[{"name":"success","destination":"save_subscribers","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"InsertMapIntoDB","name":"save_subscribers","properties":{"tableName":"Subscriptions","batchSize":200},"outputs":[],"itemAttributes":{},"extendsStep":null},{"type":"ToMap","name":"channel_map","properties":{"mappings":{"PublishedAt":"@{toDateTime(evalJson(item, '$.snippet.publishedAt'), 'yyyy-MM-dd\\'T\\'HH:mm:ss[.SSS]\\'Z\\'')}","Id":"@{evalJson(item, '$.id')}","Title":"@{evalJson(item, '$.snippet.title')}","Description":"@{evalJson(item, '$.snippet.description')}","ViewCount":"@{toLong(evalJson(item, '$.statistics.viewCount'))}","CommentCount":"@{toLong(evalJson(item, '$.statistics.commentCount'))}","SubscriberCount":"@{toLong(evalJson(item, '$.statistics.subscriberCount'))}","VideoCount":"@{toLong(evalJson(item, '$.statistics.videoCount'))}","PrivacyStatus":"@{evalJson(item, '$.status.privacyStatus')}"}},"outputs":[{"name":"success","destination":"save_channels","condition":null}],"itemAttributes":{},"extendsStep":null},{"type":"InsertMapIntoDB","name":"save_channels","properties":{"tableName":"Channels","batchSize":200},"outputs":[],"itemAttributes":{},"extendsStep":null}],"excludes":["clean_playlists","clean_videos"],"generalSteps":[],"dependencies":null,"ignoreExceptionTypes":null,"exceptionIgnoreExpression":null},"extractor":{"id":0,"publicId":null,"lastExecution":null,"startExecution":null,"finishExecution":null,"queuedExecution":null,"nextExecution":null,"timeUnit":null,"timePeriod":0,"active":false,"status":null,"errorType":null,"message":null,"errorCounter":0,"fullExtraction":true},"connectorCredentials":{"id":0,"organizationId":28,"datasourceId":99,"connectorType":null,"creationDate":null,"refreshToken":"1//03rhXyfbJ34wdCgYIARAAGAMSNwF-L9Ir-NJ-Kcl7_Qu7z2H_TCbjh6e42gs9X6OtvI8iYDa-qmVmrQw2cKx2xSGFl1csQhVuNUc","datamart":"localhost","config":"{\"properties\":{\"pageId\":\"112263752521477124308\",\"domain\":\"mettrr\",\"customFields\":[{\"id\":360001124611,\"title\":\"3rd Line Tech Support (UK) Type of Change/Request\"},{\"id\":360001486852,\"title\":\"3rd Line Adwords management Type of Change/Request\"},{\"id\":360001486872,\"title\":\"3rd Line Product support Type of Change/Request\"},{\"id\":360001063512,\"title\":\"2nd Line Legacy CWT Type of Change/Request\"},{\"id\":360002165852,\"title\":\"Mark as Spam\"},{\"id\":360001063532,\"title\":\"3rd Line Accounts and Admin (UK) Type of Change/Request\"},{\"id\":360001062512,\"title\":\"2nd Line CWT Type of Change/Request\"},{\"id\":360001123991,\"title\":\"1st Line Type of Change/Request\"},{\"id\":360001124771,\"title\":\"3rd Line Content (UK) Type of Change/Request\"},{\"id\":360001227172,\"title\":\"Country\"},{\"id\":360001124011,\"title\":\"2nd Line CTT Type of Change/Request\"},{\"id\":360001227992,\"title\":\"Phone Number - Only from form submission\"}],\"clientCustomerIds\":[\"8670301477\"],\"reports\":[\"PLACEHOLDER_REPORT_Normal\",\"PLACEMENT_PERFORMANCE_REPORT_Normal\",\"PRODUCT_PARTITION_REPORT_Normal\",\"SEARCH_QUERY_PERFORMANCE_REPORT_Normal\",\"SHOPPING_PERFORMANCE_REPORT_ConversionSegmented\",\"SHOPPING_PERFORMANCE_REPORT_Normal\",\"TOP_CONTENT_PERFORMANCE_REPORT_Normal\",\"URL_PERFORMANCE_REPORT_ConversionSegmented\",\"URL_PERFORMANCE_REPORT_Normal\",\"USER_AD_DISTANCE_REPORT_Normal\",\"VIDEO_PERFORMANCE_REPORT_ConversionSegmented\",\"VIDEO_PERFORMANCE_REPORT_Normal\"]},\"to\":[],\"oauthAccessTokenSecret\":\"oLZCb0LjGWAmmTONV8ciiz9f6ng488dncQps2h1eo2s2D\"}","extractor":null}}