{"processDefinition":{"name":"Pinterest","steps":[{"type":"Pinterest","name":"get_managing_companies","properties":{"url":"https://api.pinterest.com/v1/me/","params":{"fields":"counts","limit":100}},"outputs":[{"name":"success","destination":"clean_user_stats"}],"itemAttributes":{},"x":0,"y":0},{"type":"Pinterest","name":"get_boards","properties":{"url":"https://api.pinterest.com/v1/me/boards/","params":{"limit":100,"fields":"id,name,url,description,counts,created_at,creator"}},"outputs":[{"name":"success","destination":"clean_boards"},{"name":"success","destination":"clean_board_stats"}],"itemAttributes":{},"x":0,"y":120},{"type":"DeleteFromDB","name":"clean_board_stats","properties":{"tableName":"BoardStats","predicates":[{"field":"extraction_date","operator":">=","value":"@{currentDate().atStartOfDay()}"}]},"outputs":[{"name":"success","destination":"split_boards_for_stats"}],"itemAttributes":{},"x":270,"y":120},{"type":"SplitJsonArray","name":"split_boards_for_stats","properties":{"propertyJsonArray":"@{evalJson(item, '$.data')}"},"outputs":[{"name":"success","destination":"map_board_stats"}],"itemAttributes":{},"x":540,"y":120},{"type":"ToMap","name":"map_board_stats","properties":{"mappings":{"followers":"@{evalJson(item, '$.counts.followers')}","collaborators":"@{evalJson(item, '$.counts.collaborators')}","pins":"@{evalJson(item, '$.counts.pins')}","boardId":"@{evalJson(item, '$.id')}","extraction_date":"@{now()}"}},"outputs":[{"name":"success","destination":"save_board_stats"}],"itemAttributes":{},"x":810,"y":120},{"type":"InsertMapIntoDB","name":"save_board_stats","properties":{"tableName":"BoardStats","batchSize":200,"fields":["boardId","followers","collaborators","pins","extraction_date"]},"outputs":[],"itemAttributes":{},"x":1080,"y":120},{"type":"DeleteFromDB","name":"clean_boards","properties":{"tableName":"Boards"},"outputs":[{"name":"success","destination":"split_boards"}],"itemAttributes":{},"x":270,"y":240},{"type":"SplitJsonArray","name":"split_boards","properties":{"propertyJsonArray":"@{evalJson(item, '$.data')}"},"outputs":[{"name":"success","destination":"map_boards"}],"itemAttributes":{},"x":540,"y":240},{"type":"ToMap","name":"map_boards","properties":{"mappings":{"created_at":"@{toDateTime(evalJson(item, '$.created_at'), 'yyyy-MM-dd\\'T\\'HH:mm:ss')}","creatorId":"@{evalJson(item, '$.creator.id')}","creatorName":"@{evalJson(item, '$.creator.first_name')} @{evalJson(item, '$.creator.last_name')}","name":"@{evalJson(item, '$.name')}","description":"@{evalJson(item, '$.description')}","id":"@{evalJson(item, '$.id')}","url":"@{evalJson(item, '$.url')}"}},"outputs":[{"name":"success","destination":"save_boards"}],"itemAttributes":{},"x":810,"y":240},{"type":"InsertMapIntoDB","name":"save_boards","properties":{"tableName":"Boards","batchSize":200,"fields":["created_at","id","creatorId","creatorName","name","description","url"]},"outputs":[],"itemAttributes":{},"x":1080,"y":240},{"type":"Pinterest","name":"get_pins","properties":{"url":"https://api.pinterest.com/v1/me/pins/","params":{"limit":100,"fields":"id,link,url,creator,board(id),created_at,note,color,counts,media,attribution,image,metadata"}},"outputs":[{"name":"success","destination":"clean_pins"},{"name":"success","destination":"clean_pin_stats"}],"itemAttributes":{},"x":0,"y":360},{"type":"DeleteFromDB","name":"clean_pin_stats","properties":{"tableName":"PinStats","predicates":[{"field":"extraction_date","operator":">=","value":"@{currentDate().atStartOfDay()}"}]},"outputs":[{"name":"success","destination":"split_pins_for_stats"}],"itemAttributes":{},"x":270,"y":360},{"type":"SplitJsonArray","name":"split_pins_for_stats","properties":{"propertyJsonArray":"@{evalJson(item, '$.data')}"},"outputs":[{"name":"success","destination":"map_pin_stats"}],"itemAttributes":{},"x":540,"y":360},{"type":"ToMap","name":"map_pin_stats","properties":{"mappings":{"comments":"@{evalJson(item, '$.counts.comments')}","saves":"@{evalJson(item, '$.counts.comments')}","pinId":"@{evalJson(item, '$.id')}","boardId":"@{evalJson(item, '$.board.id')}","extraction_date":"@{now()}"}},"outputs":[{"name":"success","destination":"save_pin_stats"}],"itemAttributes":{},"x":810,"y":360,"propertiesString":"{\n\t\"mappings\": {\n\t\t\"comments\": \"@{evalJson(item, '$.counts.comments')}\",\n\t\t\"saves\": \"@{evalJson(item, '$.counts.comments')}\",\n\t\t\"pinId\": \"@{evalJson(item, '$.id')}\",\n\t\t\"boardId\": \"@{evalJson(item, '$.board.id')}\",\n\t\t\"extraction_date\": \"@{now()}\"\n\t}\n}","attributesString":"{}"},{"type":"InsertMapIntoDB","name":"save_pin_stats","properties":{"tableName":"PinStats","batchSize":200,"fields":["pinId","boardId","comments","saves","extraction_date"]},"itemAttributes":{},"x":1080,"y":360},{"type":"DeleteFromDB","name":"clean_pins","properties":{"tableName":"Pins"},"outputs":[{"name":"success","destination":"split_pins"}],"itemAttributes":{},"x":270,"y":480},{"type":"SplitJsonArray","name":"split_pins","properties":{"propertyJsonArray":"@{evalJson(item, '$.data')}"},"outputs":[{"name":"success","destination":"map_pins"}],"itemAttributes":{},"x":540,"y":480},{"type":"ToMap","name":"map_pins","properties":{"mappings":{"created_at":"@{toDateTime(evalJson(item, '$.created_at'), 'yyyy-MM-dd\\'T\\'HH:mm:ss')}","creatorId":"@{evalJson(item, '$.creator.id')}","creatorName":"@{evalJson(item, '$.creator.first_name')} @{evalJson(item, '$.creator.last_name')}","note":"@{evalJson(item, '$.note')}","id":"@{evalJson(item, '$.id')}","url":"@{evalJson(item, '$.url')}","boardId":"@{evalJson(item, '$.board.id')}","color":"@{evalJson(item, '$.color')}","mediaType":"@{evalJson(item, '$.media.type')}","imageUrl":"@{evalJson(item, '$.image.original.url')}"}},"outputs":[{"name":"success","destination":"save_pins"}],"itemAttributes":{},"x":810,"y":480},{"type":"InsertMapIntoDB","name":"save_pins","properties":{"tableName":"Pins","batchSize":200,"fields":["note","id","creatorName","creatorId","boardId","url","color","mediaType","imageUrl","created_at"]},"itemAttributes":{},"x":1080,"y":480},{"type":"DeleteFromDB","name":"clean_user_stats","properties":{"tableName":"UserStats","predicates":[{"field":"extraction_date","operator":">=","value":"@{currentDate().atStartOfDay()}"}]},"outputs":[{"name":"success","destination":"map_user_stats"}],"itemAttributes":{},"x":270,"y":0},{"type":"ToMap","name":"map_user_stats","properties":{"mappings":{"followers":"@{evalJson(item, '$.data.counts.followers')}","following":"@{evalJson(item, '$.data.counts.following')}","boards":"@{evalJson(item, '$.data.counts.boards')}","pins":"@{evalJson(item, '$.data.counts.pins')}","extraction_date":"@{now()}"}},"outputs":[{"name":"success","destination":"save_user_stats"}],"itemAttributes":{},"x":540,"y":0},{"type":"InsertMapIntoDB","name":"save_user_stats","properties":{"tableName":"UserStats","fields":["followers","following","boards","pins","extraction_date"]},"outputs":[],"itemAttributes":{},"x":810,"y":0}],"excludes":[],"generalSteps":[]},"extractor":{"id":0,"timePeriod":0,"active":false,"errorCounter":0},"connectorCredentials":{"id":0,"organizationId":35,"datasourceId":616,"refreshToken":"AhGiRYm9krf0-yiip9bLpXrblvlAFUtLZtqW5xRE3Lk2UMA4mApxQDAAARnpROcDe0ogOYcAAAAA","datamart":"localhost","config":{"properties":{"pageId":"100230508074773910534","domain":"mettrr","customFields":[{"id":360001124611,"title":"3rd Line Tech Support (UK) Type of Change/Request"},{"id":360001486852,"title":"3rd Line Adwords management Type of Change/Request"},{"id":360001486872,"title":"3rd Line Product support Type of Change/Request"},{"id":360001063512,"title":"2nd Line Legacy CWT Type of Change/Request"},{"id":360002165852,"title":"Mark as Spam"},{"id":360001063532,"title":"3rd Line Accounts and Admin (UK) Type of Change/Request"},{"id":360001062512,"title":"2nd Line CWT Type of Change/Request"},{"id":360001123991,"title":"1st Line Type of Change/Request"},{"id":360001124771,"title":"3rd Line Content (UK) Type of Change/Request"},{"id":360001227172,"title":"Country"},{"id":360001124011,"title":"2nd Line CTT Type of Change/Request"},{"id":360001227992,"title":"Phone Number - Only from form submission"}],"clientCustomerIds":["8670301477"],"reports":["PLACEHOLDER_REPORT_Normal","PLACEMENT_PERFORMANCE_REPORT_Normal","PRODUCT_PARTITION_REPORT_Normal","SEARCH_QUERY_PERFORMANCE_REPORT_Normal","SHOPPING_PERFORMANCE_REPORT_ConversionSegmented","SHOPPING_PERFORMANCE_REPORT_Normal","TOP_CONTENT_PERFORMANCE_REPORT_Normal","URL_PERFORMANCE_REPORT_ConversionSegmented","URL_PERFORMANCE_REPORT_Normal","USER_AD_DISTANCE_REPORT_Normal","VIDEO_PERFORMANCE_REPORT_ConversionSegmented","VIDEO_PERFORMANCE_REPORT_Normal"]},"to":[],"oauthAccessTokenSecret":"oLZCb0LjGWAmmTONV8ciiz9f6ng488dncQps2h1eo2s2D"}}}